generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model PositionsClmm {
  positionMint  String   @id
  wallet        String
  poolId        String
  tokenA        String
  tokenB        String
  decA          Int
  decB          Int
  tickLower     Int
  tickUpper     Int
  lastLiquidity String
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@index([wallet])
  @@index([tokenA])
  @@index([tokenB])
  @@index([updatedAt])
}

model TxEvent {
  txSig          String   @id
  wallet         String
  mint           String
  positionMint   String?
  poolId         String?
  action         String
  amountA        String?
  amountB        String?
  liquidityDelta String?
  success        Boolean  @default(true)
  ts             DateTime @default(now())
  dex            String?
  flatSol        Float?
  skimA          String?
  skimB          String?
  skimBp         Int?

  @@index([wallet])
  @@index([mint])
  @@index([dex])
}

model ProAccess {
  wallet    String    @id
  txSig     String
  expiresAt DateTime?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@index([wallet])
  @@index([expiresAt])
}

model AdminSession {
  id         String    @id @default(cuid())
  wallet     String
  nonce      String
  used       Boolean   @default(false)
  createdAt  DateTime  @default(now())
  verifiedAt DateTime?

  @@index([wallet])
  @@index([nonce])
  @@index([createdAt])
}

model CreatedToken {
  mint               String    @id
  creatorWallet      String    @db.VarChar(64)
  name               String
  ticker             String
  createdAt          DateTime  @default(now())
  amount             String?
  decimals           String?
  description        String?
  image              String?
  links              Json?
  preset             String?
  symbol             String?
  vibe               String?
  paidAmount         Float?
  paymentTxSignature String?
  paymentVerified    Boolean   @default(false)
  paymentVerifiedAt  DateTime?
  tier               String    @default("free")

  @@index([creatorWallet])
  @@index([createdAt])
  @@index([symbol])
  @@index([preset])
  @@index([vibe])
  @@index([tier])
  @@index([paymentTxSignature])
  @@index([paymentVerified])
}

model FlowCompletion {
  id            String    @id @default(cuid())
  tokenMint     String
  creatorWallet String
  honestLaunch  Boolean   @default(false)
  marketingKit  Boolean   @default(false)
  liquidity     Boolean   @default(false)
  completedAt   DateTime?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  @@unique([tokenMint, creatorWallet])
  @@index([tokenMint])
  @@index([creatorWallet])
  @@index([completedAt])
}
